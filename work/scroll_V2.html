<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Device Transition</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background: #f8f8f8;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: sans-serif;
        }

        #main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        #icon-container {
            margin-bottom: 20px;
            position: relative;
            height: 40px;
            width: 40px;
        }

        .device-icon {
            position: absolute;
            top: 0;
            left: 0;
            transition: opacity 0.6s ease;
        }

        #scaling-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            transform-origin: center center;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #device-frame {
            background: #000;
            box-shadow: 0 18px 40px rgba(0,0,0,0.25);
            box-sizing: border-box;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #screen-mat {
            background: #fff;
            box-sizing: border-box;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            position: relative;
        }

        #dynamic-iframe {
            border: none;
            background: white;
            pointer-events: none;
            display: block;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1), height 0.8s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        #status-text {
            margin-top: 20px;
            color: #aaa;
            font-size: 11px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div id="main-container">
        <div id="icon-container">
            <svg id="icon-mobile" class="device-icon" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2">
                <rect x="5" y="2" width="14" height="20" rx="2"></rect>
            </svg>
            <svg id="icon-desktop" class="device-icon" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" style="opacity: 0;">
                <rect x="2" y="3" width="20" height="14" rx="2"></rect>
            </svg>
        </div>

        <div id="scaling-container">
            <div id="device-frame">
                <div id="screen-mat">
                    <iframe id="dynamic-iframe"
                            src="https://jinhakanglab.github.io/ai2html/260121_GreatPyramid/index.html"
                            scrolling="no"></iframe>
                </div>
            </div>
        </div>

        <p id="status-text">Mobile</p>
    </div>

    <script>
    const iframe = document.getElementById("dynamic-iframe");
    const scaler = document.getElementById("scaling-container");
    const frame = document.getElementById("device-frame");
    const mat = document.getElementById("screen-mat");
    const statusText = document.getElementById("status-text");

    const icons = {
      mobile: document.getElementById("icon-mobile"),
      desktop: document.getElementById("icon-desktop")
    };

    const MODES = {
      mobile:  { width: 320, height: 680, iframeHeight: 1500, bezel: 14, radius: 28 },
      desktop: { width: 800, height: 680, iframeHeight: 680, bezel: 12, radius: 18 }
    };

    let currentMode = "mobile";
    let scrollAnimation = null;

    function autoScrollMobile() {
      if (currentMode !== "mobile" || scrollAnimation) return;

      // Animate iframe vertically to simulate scrolling
      const startTop = 0;
      const endTop = -800; // Adjusted to show content without cutting off
      const duration = 4000; // 4 seconds to scroll down
      const startTime = Date.now();

      function animate() {
        if (currentMode !== "mobile") {
          cancelAnimationFrame(scrollAnimation);
          scrollAnimation = null;
          iframe.style.top = "0px";
          return;
        }

        const elapsed = Date.now() - startTime;
        const progress = (elapsed % (duration * 2)) / duration;

        let top;
        if (progress <= 1) {
          // Scroll down with easing
          const eased = progress * progress * (3 - 2 * progress); // Smooth step
          top = startTop + (endTop - startTop) * eased;
        } else {
          // Scroll back up with easing
          const eased = (progress - 1) * (progress - 1) * (3 - 2 * (progress - 1));
          top = endTop + (startTop - endTop) * eased;
        }

        iframe.style.top = top + "px";
        scrollAnimation = requestAnimationFrame(animate);
      }

      scrollAnimation = requestAnimationFrame(animate);
    }

    function stopAutoScroll() {
      if (scrollAnimation) {
        cancelAnimationFrame(scrollAnimation);
        scrollAnimation = null;
      }
      iframe.style.top = "0px";
    }

    function setMode(mode) {
      currentMode = mode;
      const { width, height, iframeHeight, bezel, radius } = MODES[mode];

      iframe.style.width = width + "px";
      iframe.style.height = iframeHeight + "px"; // Use full iframe height

      frame.style.padding = bezel + "px";
      frame.style.borderRadius = radius + "px";

      mat.style.padding = mode === "desktop" ? "10px" : "8px";
      mat.style.borderRadius = Math.max(radius - 10, 12) + "px";
      mat.style.height = height + "px"; // Set container height for clipping

      iframe.style.borderRadius = Math.max(radius - 16, 8) + "px";

      icons.mobile.style.opacity = mode === "mobile" ? 1 : 0;
      icons.desktop.style.opacity = mode === "desktop" ? 1 : 0;

      statusText.textContent = mode.charAt(0).toUpperCase() + mode.slice(1);

      const totalWidth = width + bezel * 2;
      const maxW = window.innerWidth * 0.85;

      if (totalWidth > maxW) {
        scaler.style.transform = `scale(${maxW / totalWidth})`;
      } else {
        scaler.style.transform = "scale(1)";
      }

      try {
        iframe.contentWindow.dispatchEvent(new Event("resize"));
      } catch {
        iframe.contentWindow.postMessage("resize", "*");
      }

      // Start auto-scroll for mobile, stop for desktop
      if (mode === "mobile") {
        setTimeout(autoScrollMobile, 500); // Wait for iframe to settle
      } else {
        stopAutoScroll();
      }
    }

    function animate() {
      const nextMode = currentMode === "mobile" ? "desktop" : "mobile";
      setMode(nextMode);
    }

    // Initialize
    setMode("mobile");

    // Start animation cycle (2 seconds per view)
    setInterval(animate, 2000);

    // Handle window resize
    window.addEventListener("resize", () => setMode(currentMode));
    </script>
</body>
</html>